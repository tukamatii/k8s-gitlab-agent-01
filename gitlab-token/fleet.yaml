# fleet.yaml

defaultNamespace: prom-cilium

namespaceLabels:
  okbtsp.corp/department: OIT
  okbtsp.corp/owner: baranav
  okbtsp.corp/project: prom-cilium
  prom-config: prom-operator-main

helm:
  takeOwnership: true
  force: true

name: prom-cilium

kustomize:
  dir: "base"

# Кастомизация под кластеры
targetCustomizations:
  # === PROD ===
  - name: prod
    clusterSelector:
      matchLabels:
        okbtsp.corp/template: talos-vmware
    helm:
      takeOwnership: true
      force: true
      chart: ./helm
      values:
        clusterName: ${ if hasKey .ClusterLabels "management.cattle.io/cluster-display-name" }${ get .ClusterLabels "management.cattle.io/cluster-display-name" }${ else }${ .ClusterName }${ end }

dependsOn:
  - name: external-secrets
  - name: mimir
  - name: prom-operator
